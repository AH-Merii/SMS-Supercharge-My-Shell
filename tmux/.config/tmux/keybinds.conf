##### Keybindings #####

# Vim-style pane movement
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Split windows keeping cwd
bind '"' split-window -v -c "#{pane_current_path}"
bind %   split-window -h -c "#{pane_current_path}"

# Move between panes with Alt + Arrows
bind -n M-Left  select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up    select-pane -U
bind -n M-Down  select-pane -D

# Switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window
bind -n M-H     previous-window
bind -n M-L     next-window

# Copy-mode (vi)
bind-key -T copy-mode-vi v   send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y   send-keys -X copy-selection-and-cancel

##### Splits
# Alt+v → vertical split (top/bottom)
bind -n M-v split-window -v
# Alt+s → horizontal split (left/right)
bind -n M-s split-window -h

##### Windows & Sessions
# Alt+n → new window
bind -n M-n new-window
# Alt+N → new session
bind -n M-N new-session

##### Rename (pane/window)
# Alt+r → rename current pane (pane title)
bind -n M-r command-prompt -p "Pane title:" 'select-pane -T "%%"'
# Alt+R → rename current window (pre-fill with current name)
bind -n M-R command-prompt -I "#W" -p "Rename window:" 'rename-window "%%"'

##### Close (pane/window) — immediate
# Alt+c → close pane
bind -n M-c kill-pane
# Alt+C → close window
bind -n M-C kill-window

#TODO: Fix Kill commands below as they currently do nothing after confirmation and always cancel
##### Close (session/server) — with confirmation prompts
# Alt+x → kill current session (prompt)
bind -n M-x command-prompt -p "Kill session '#S'? (y/N)" \
  'if-shell -F "#{m:^[Yy]$,%%}" "kill-session" "display-message \"Canceled\""'

# Alt+X → kill tmux server (prompt)
bind -n M-X command-prompt -p "Kill tmux server? (y/N)" \
  'if-shell -F "#{m:^[Yy]$,%%}" "kill-server" "display-message \"Canceled\""'


# Ctrl + Alt + R → Reload config and plugins with centered popup
bind -n C-M-r display-popup -T "Reload Config" "sh -lc '
  printf \"\033[38;5;80m  Reloading tmux configuration...\033[0m\n\n\";
  tmux source-file ~/.config/tmux/tmux.conf;
  tmux run-shell ~/.config/tmux/plugins/tpm/bin/install_plugins;
  printf \"\n\033[32m Tmux config &   plugins reloaded successfully!\033[0m\n\";
  printf \"\nPress any esc to close...\n\";
'"


